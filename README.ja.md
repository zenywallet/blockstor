# Blockstor
Block Explorer API for Wallet Service

## Features
- ウォレットサービスのバックエンド向けに特化した Block Explorer です。
> 一般的な Block Explorer は多くの情報を保持し情報表示に関しては多機能ですが、ウォレットサービスには不要な部分が多く含まれています。
> Blockstor ではウォレットサービスに不要な部分を排除し、レスポンス向上のためにデータ構造を最適化しています。
> Blockstor は、Webウォレット等のクライアントから直接利用するためのAPIサービスではなく、ユーザーウォレットのアドレス等を管理するサーバー側のウォレットサービスからアクセスすることを想定しています。
- REST APIのクエリはどんなものでもすべて高速に返します。
> UTXOやアドレスの送受信履歴も一瞬で返します。
- パラメータ設定のみでBitcoinベースのアルトコイン対応ができます。
> アルトコイン用のハッシュアルゴリズム等を実装する必要はありません。
> ただ、このことはブロックのハッシュ計算やチェーンの検証は Core に任せることを意味します。
> そのため、信頼できる Core を用意する必要があります。
- コインの最大数量は64ビットまでサポートしており、Bitcoinより発行枚数を増やしたアルトコインに対応できます。
> ただし、Javascriptの仕様により53ビットの数値までしか扱えないので、Number.MAX_SAFE_INTEGER (9007199254740991) より大きな数値は、数値ではなく数字の文字列に変換されます。
- ウォレットサービス側でデータ読み出し位置を管理でき、データの同期を効率的にできます。
> Blockstor 内のトランザクション情報は、Genesis Block のトランザクションから順番にシーケンス番号を割り当てて管理しています。
> 特定のシーケンス番号より新しい情報のみを取得するなどが可能です。
> また、Orphan Block が発生しブロックがロールバックした場合は、巻き戻された位置のシーケンス番号を取得することができます。
> その他、シーケンス番号は取引履歴の表示順をソートするなどのためにも利用できます。
- WebSocketによるストリーミングAPIでリアルタイムな情報を受信できます。
> 確認済みとなったブロックのデータや未確認状態のトランザクションの情報を受信できます。
> いずれもアドレスベースに整理されており、ウォレットサービス側で必要なアドレスの情報のみをフィルタリングすることが容易にできます。
- UTXOの数を簡単に取得できます。
> マイニングプール等からの受信回数が極めて多いアドレスが増えてきており、一度に送信することができなくなった状態のウォレットがたくさんあるようです。
> アドレスの入力トランザクション数の把握したり、細分化した入力トランザクションをまとめることで一括で送信できるような状態にする機能等の実現に利用できます。
- ブロックをインデックスする際は、高速なTCP接続とRPC接続の両方をサポートしています。
> サービス起動時はTCP接続モードでブロックのインデックスを試し、接続失敗した場合はRPC接続モードにフォールバックします。
> ただし、RPC接続モードはTCP接続モードに比べると低速です。すべてのブロックを同期した後はRPC接続モードで動作します。
- bitcoinjs を利用し、SegWit アドレスに対応しています。
> コインの数量を64ビットまで扱えるようにした bitcoinjs を利用しています。それはWebブラウザ等のクライアント側でも利用できます。
- 改造がしやすいシンプルなコードです。
> 取得情報を追加することも可能です。例えばランキングシステムなども簡単に作成できます。

## Installation
``` bash
git clone https://github.com/zenywallet/blockstor
cd blockstor
npm install
```

## Configuration
``` bash
cd config
cp default-sample.json5 default.json5
vi default.json5
cd ..
```

## Start
``` bash
node index.js
```
